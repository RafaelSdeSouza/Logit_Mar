text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_stata()
ggs_histogram(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_stata()
ggs_density(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_stata()
ggs_traceplot(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_stata()
jags.normal<-jags.model(
data = jags.data,
inits = inits,
textConnection(model.normal),
n.chains = 3,
n.adapt=1000
)
update(jags.normal, 5000)
posterior.normal <- coda.samples(jags.normal, params, n.iter = 20000)
G1<-ggs(posterior.normal)
ggs_traceplot(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=25),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_stata()
ggs_traceplot(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=20),
axis.text.x=element_text(size=20),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_stata()
ggs_traceplot(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_stata()
ggs_traceplot(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_gdocs()
ggs_traceplot(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_fivethirtyeight()
install.packages(c("pander", "visreg"))
install.packages(c("abc", "arm", "BayesFactor", "BayesLCA", "BDgraph", "biomod2", "bipartite", "caret", "codetools", "d3Network", "devtools", "fastcluster", "fclust", "fdrtool", "fields", "flexmix", "foreign", "gam", "gbm", "geoR", "geoRglm", "gplots", "gtools", "intergraph", "KernSmooth", "kohonen", "mnormt", "NbClust", "networkD3", "pander", "qgraph", "RColorBrewer", "Rcpp", "RcppArmadillo", "RcppGSL", "RCurl", "RgoogleMaps", "rjags", "rmarkdown", "roxygen2", "rstudioapi", "runjags", "sp", "spam", "survival", "sysfonts", "TH.data", "tikzDevice", "vegan", "VGAM", "WriteXLS"), lib="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
install.packages(c("abc", "arm", "BayesFactor", "BayesLCA", "BDgraph",
install.packages("pander", lib="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
)
l
qplot(carat, price, data=dsamp, colour=cut)
+ theme_stata()
+ scale_colour_stata()
+ ggtitle("Plot Title")
library(rjags)
library(ggmcmc)
library(ggplot2)
library(ggthemes)
library(pander)
library(Cairo)
library(plyr)
library(MASS)
library(scales)
# Read data
qplot(carat, price, data=dsamp, colour=cut)
+ theme_stata()
+ scale_colour_stata()
+ ggtitle("Plot Title")
qplot(months, temp, data=dtemp, group=city, color=city, geom="line") +
geom_point(size=1.1) +
theme_hc(bgcolor = "darkunica") +
scale_fill_hc("darkunica")
qplot(carat, price, data = dsamp, colour = cut)
+ theme_hc()
+ scale_colour_hc()
qplot(carat, price, data = dsamp, colour = cut)
+theme_hc()+scale_colour_hc()
qplot(carat, price, data = dsamp, colour = cut)+theme_hc()+scale_colour_hc()
qplot(carat, price, data = diamonds, colour = cut)+theme_hc()+scale_colour_hc()
qplot(carat, price, data = diamonds[1:100,], colour = cut)+theme_hc()+scale_colour_hc()
qplot(carat, price, data = diamonds[1:1000,], colour = cut)+theme_hc()+scale_colour_hc()
qplot(carat, price, data = diamonds, colour = cut)+theme_hc()+scale_colour_hc()
qplot(carat, price, data = diamonds, colour = cut)+theme_few()+scale_colour_hc()
qplot(carat, price, data = diamonds, colour = cut)+theme_few()+scale_colour_stata()
qplot(carat, price, data = diamonds, colour=clarity)+theme_few()+scale_colour_stata()
qplot(carat, price, data = diamonds[sample(nrow(diamonds), 1000), ], colour=clarity)+theme_few()+scale_colour_stata()
qplot(carat, price, data = diamonds[sample(nrow(diamonds), 1000), ], colour=clarity)+theme_few()+scale_colour_fivethirtyeight()
ggs_density(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_fivethirtyeight()
ggs_density(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_few()
ggs_density(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))
ggs_density(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_economist()
ggs_autocorrelation(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_economist()
ggs_autocorrelation(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_economist()+scale_fill_economist()
require(ggplot2)
#to get ggthemes from jrnold github if you have not installed
#require(devtools)
#install_github("ggthemes","jrnold")
require(ggthemes)
require(reshape2)
require(directlabels)
require(quantmod)
require(PerformanceAnalytics)
tckrs <- c("CSCO","MSFT","AAPL","^GSPC")
getSymbols(tckrs,from="1990-01-01")
prices <- na.omit(merge(CSCO[,6],MSFT[,6],AAPL[,6],GSPC[,6]))
colnames(prices) <- c("Cisco","Microsoft","Apple","SP500")
returns <- prices/lag(prices) - 1
returns[1,] <- 0
cumul <- cumprod(returns+1)
cumul.df <- as.data.frame(cbind(index(cumul),coredata(cumul)))
cumul.melt <- melt(cumul.df,id.vars=1)
colnames(cumul.melt) <- c("Date","Stock","Cumul")
cumul.melt[,"Date"] <- as.Date(cumul.melt[,"Date"])
direct.label(
ggplot(cumul.melt, aes(x=Date,y=log(Cumul),colour=Stock)) +
geom_line() +
theme_economist() +  #if you want to play try theme_wsj() or theme_few()
scale_colour_economist() +
ggtitle("Apple Compared to Others Since 1990")
, list(last.bumpup,hjust=0.45,cex=0.65))
direct.label(
ggplot(cumul.melt, aes(x=Date,y=log(Cumul),colour=Stock)) +
geom_line() +
theme_economist_white() +  #if you want to play try theme_wsj() or theme_few()
scale_colour_economist() +
ggtitle("Apple Compared to Others Since 1990")
, list(last.bumpup,hjust=0.45,cex=0.65))
#for reference I will use my old favorite theEconomist from latticeExtra
require(latticeExtra)
direct.label(
asTheEconomist(xyplot(log(Cumul)~Date,data=cumul.melt,groups=Stock,
main="Apple Compared to Microsoft and Cisco Since 1990")
)
, list(last.bumpup,hjust=0.25,cex=1))
setwd("~/Dropbox/artigos/Meusartigos/IAA-WGC/Github/Logit_Mar/script ")
# JAGS Code with Adaptive Shrinkage
#  Required libraries
library(rjags)
library(ggmcmc)
library(ggplot2)
library(ggthemes)
library(pander)
library(Cairo)
library(MASS)
library(scales)
library(plyr)
require(gdata)
require(runjags)
require(gdata)
require(caret)
require(pROC)
require(plyr)
# Read and format data
data<-read.csv("..//data/Logit_sample-2.csv",header=TRUE,na.strings="")
data2<-na.omit(data)
data2<-data2[data2$logMstar_p50>0,]
data2<-data2[which(data2$sigma>0),]
data2<-data2[which(data2$rvir>0),]
trainIndex <- sample(1:nrow(data2),1000)
data3<-data2[trainIndex,]
#data2$bpt<-as.factor(data2$bpt)
data3$bpt <- revalue(data3$bpt,c("Star Forming"="0","Composite"="0","Composi"="0",
"LINER"="1","Seyfert/LINER"="1","Star Fo"="0",
"Seyfert"="1","BLANK"="0"))
data3$R_rvir = data3$Rproj_L/data3$rvir
# Prepare data for JAGS
data3$logMstar_p50<-(data3$logMstar_p50-mean(data3$logMstar_p50))/sd(data3$logMstar_p50)
data3$logMhalo<-(data3$logMhalo-mean(data3$logMhalo))/sd(data3$logMhalo)
#data2$vlos_sigma<-(data2$vlos_sigma-mean(data2$vlos_sigma))/sd(data2$vlos_sigma)
data3$R_rvir<-(data3$R_rvir-mean(data3$R_rvir))/sd(data3$R_rvir)
X<-model.matrix(~logMstar_p50+logMhalo+R_rvir,data=data3)
K<-ncol(X)
jags.data <- list(Y= as.numeric(data3$bpt)-1,
N = nrow(data3),
X=X,
#                  b0 = rep(0,K),
#                  B0=diag(1e-4,K),
Npred = K
)
model<-"model{
#1. Priors
#beta~dmnorm(b0[],B0[,]) # Normal Priors
# Jefreys priors for sparseness
for(j in 1:Npred)   {
lnTau[j] ~ dunif(-50, 50)
TauM[j] <- exp(lnTau[j])
beta[j] ~ dnorm(0, TauM[j])
Ind[j] <- step(abs(beta[j]) - 0.05)
}
#2. Likelihood
for(i in 1:N){
Y[i] ~ dbern(pi[i])
logit(pi[i]) <-  eta[i]
eta[i] <- inprod(beta[], X[i,])
#3. Prediction
NewPred[i]~dbern(pi[i])
}
}"
params <- c("beta","pi","Ind","NewPred")
inits0  <- function () {
list(beta = rnorm(K, 0, 0.01))}
inits1=inits0()
inits2=inits0()
inits3=inits0()
library(parallel)
cl <- makeCluster(3)
jags.logit <- run.jags(method="rjparallel",
data = jags.data,
inits = list(inits1,inits2,inits3),
model=model,
n.chains = 3,
adapt=1000,
monitor=c(params),
burnin=5000,
sample=15000,
summarise=FALSE,
plots=FALSE
)
jagssamples <- as.mcmc.list(jags.logit)
jagssamples
G1<-ggs(jagssamples,family="beta")
G1
ggs_density(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))
ggs_caterpillar(G1)+theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))
predAGN<-summary(as.mcmc.list(jags.logit, vars="newY"))
predAGN<-predAGN$quantiles
pi_AGN<-summary(as.mcmc.list(jags.logit, vars="pi"))
pi_AGN<-pi_AGN$quantiles
pi_AGN
pi_AGN[1,]
gdata<-data.frame(x=data3$logMstar_p50,y=pi_AGN[,3])
ggplot(aes(x=x,y=y),data=gdata)+geom_point()+
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))
pi_AGN[1,]
gdata<-data.frame(x=data3$logMstar_p50,mean=pi_AGN[,3],lwr1=pi_AGN[,2],lwr2=pi_AGN[,1],upr1=pi_AGN[,4],upr2=pi_AGN[,5])
ggplot(aes(x=x,y=mean),data=gdata)+geom_point()+
geom_ribbon(data=gdata,aes(x=xx,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#00526D")) +
geom_ribbon(data=gdata,aes(x=xx,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#00A3DB")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))
ggplot(aes(x=x,y=mean),data=gdata)+geom_point()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#00526D")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#00A3DB")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#00526D")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#00A3DB")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#00526D")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#00A3DB")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
P1<-ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#00526D")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#00A3DB")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
scale_fill_manual(values=c("#00526D", "#00A3DB", "#7A2713", "#939598", "#6CCFF6"))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
cairo_pdf("logit_AGN.pdf",width = 8, height = 7)
P1
dev.off()
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#00526D")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#00A3DB")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
scale_colour_manual(values=c("#005A04", "#CCFFBB"))+
scale_fill_manual(values=c("#005A04", "#CCFFBB"))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005A04")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#CCFFBB")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
P1<-ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_few()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
cairo_pdf("logit_AGN.pdf",width = 8, height = 7)
P1
dev.off()
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_tufte()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_wsj()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_hc()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_gdocs()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_hc()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
P1<-ggplot(aes(x=x,y=mean),data=gdata)+geom_line()+
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr1, ymax=upr1), alpha=0.45, fill=c("#005502")) +
geom_ribbon(data=gdata,aes(x=x,y=mean,ymin=lwr2, ymax=upr2), alpha=0.35, fill=c("#3A5F0B")) +
theme_hc()+
theme(legend.position="none",plot.title = element_text(hjust=0.5),
axis.title.y=element_text(vjust=0.75),axis.text.x=element_text(size=18),
axis.text.y=element_text(size=18),
strip.text.x=element_text(size=25),
axis.title.x=element_text(vjust=-0.25),
text = element_text(size=20),axis.title.x=element_text(size=rel(1)))+
xlab(expression(log~M[star]))+ylab(expression(P[AGN]))
cairo_pdf("logit_AGN.pdf",width = 8, height = 7)
P1
dev.off()
data3[1,]
